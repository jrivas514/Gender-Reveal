<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>RevelaciÃ³n â€” Aterrizaje</title>
<style>
  :root{
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  }
  html,body{height:100%;margin:0;background:#000;color:#fff;overflow:hidden}

  /* Secuencia (las 4 imÃ¡genes). En el final queda visible la Ãºltima. */
  #runway-seq{position:fixed;inset:0;z-index:0;opacity:0;transition:opacity .4s ease;background:#000;overflow:hidden}
  #runway-seq.show{opacity:1}
  #runway-seq img{
    position:absolute;inset:0;width:100%;height:100%;object-fit:cover;
    opacity:0;transform:scale(1);transition:opacity .8s ease, transform 2.6s ease;
  }
  #runway-seq img.show{
    opacity:1;
    animation:zoomIn 3s forwards, shakeSmall .25s infinite;
  }
  @keyframes zoomIn{from{transform:scale(1)}to{transform:scale(1.15)}}
  @keyframes shakeSmall{
    0%{transform:translate(0,0) scale(1.05)}
    25%{transform:translate(-2px,1px) scale(1.06)}
    50%{transform:translate(2px,-1px) scale(1.07)}
    75%{transform:translate(-1px,2px) scale(1.08)}
    100%{transform:translate(0,0) scale(1.09)}
  }
  .touchdown{animation:bump .7s ease-out}
  @keyframes bump{
    0%{transform:translateY(0) scale(1.15)}
    40%{transform:translateY(12px) scale(1.1)}
    70%{transform:translateY(-6px) scale(1.12)}
    100%{transform:translateY(0) scale(1.15)}
  }

  /* Tarjeta inicial (se oculta por completo al revelar) */
  .card{
    width:92%;max-width:1000px;margin:auto;position:relative;z-index:10;
    background:rgba(255,255,255,.08);border-radius:20px;padding:28px;
    box-shadow:0 10px 30px rgba(0,0,0,.2);backdrop-filter:blur(6px);text-align:center;
    top:50%;transform:translateY(-50%);transition:opacity .6s ease, transform .6s ease;
  }
  .hide-out{opacity:0;transform:translateY(-50%) scale(.98);pointer-events:none}
  h1{margin:6px 0 4px;font-size:clamp(32px,6vw,64px)}
  .subtitle{opacity:.9;margin-bottom:18px}
  .countdown{display:flex;gap:12px;justify-content:center;margin:18px 0}
  .count-item{background:rgba(255,255,255,.14);padding:12px 18px;border-radius:12px;min-width:84px}
  .count-item .num{font-size:32px;font-weight:700}
  .count-item .label{font-size:14px;opacity:.9}
  .cta button{padding:10px 16px;border-radius:10px;border:0;cursor:pointer}

  /* AviÃ³n del inicio (solo para el arranque, luego ya no se ve) */
  .plane{width:140px;position:absolute;left:-200px;bottom:130px;opacity:0;transition:all 1s linear;z-index:5}
  .plane.takeoff{animation:takeoff 2s ease-in forwards}
  @keyframes takeoff{0%{left:10%;bottom:130px;opacity:1}100%{left:120%;bottom:60%;opacity:0}}

  /* Letrero final ÃšNICO */
  #only-reveal{
    position:fixed;inset:0;z-index:20;display:flex;align-items:center;justify-content:center;
    opacity:0;transition:opacity 1s ease 0.2s;pointer-events:none;
  }
  #only-reveal.show{opacity:1}
  #only-reveal .title{
    font-size:clamp(48px,9vw,140px);
    font-weight:900;letter-spacing:.5px;
    color:#ffe6f2;text-shadow:0 8px 30px rgba(0,0,0,.55), 0 0 10px rgba(255,105,180,.35);
  }

  /* Confetti (lo oculto al revelar para que quede solo la imagen + letrero) */
  canvas#confetti{position:fixed;inset:0;pointer-events:none;z-index:15}
  .confetti-hidden{display:none!important}
</style>
</head>
<body>

  <!-- Secuencia de 4 imÃ¡genes -->
  <div id="runway-seq">
    <img id="frame0" alt="frame0"/>
    <img id="frame1" alt="frame1"/>
    <img id="frame2" alt="frame2"/>
    <img id="frame3" alt="frame3"/>
  </div>

  <!-- Sonidos (opcional: si no hay archivos, simplemente no suenan) -->
  <audio id="snd-ding"    src="seatbelt-ding.mp3" preload="auto"></audio>
  <audio id="snd-engine"  src="engine-loop.mp3"    preload="auto" loop></audio>
  <audio id="snd-wind"    src="wind-rumble.mp3"    preload="auto" loop></audio>
  <audio id="snd-touch"   src="touchdown-thump.mp3" preload="auto"></audio>
  <audio id="snd-reverse" src="reverse-thrust.mp3"  preload="auto"></audio>
  <audio id="snd-roar"    src="takeoff-roar.mp3"    preload="auto"></audio>
  <audio id="snd-crowd"   src="applause-cheer.mp3"  preload="auto"></audio>

  <!-- Letrero final Ãºnico -->
  <div id="only-reveal"><div class="title">Â¡Es una NiÃ±a! ðŸ’–</div></div>

  <!-- Tarjeta inicial (solo para arrancar la demo) -->
  <div class="card" id="card">
    <h1>Â¡Despegando hacia...?</h1>
    <div class="subtitle">Destino: <strong>Bluelandia</strong> o <strong>Pinklandia</strong></div>
    <div id="countdown" class="countdown">
      <div class="count-item"><div class="num" id="days">00</div><div class="label">DÃ­as</div></div>
      <div class="count-item"><div class="num" id="hours">00</div><div class="label">Horas</div></div>
      <div class="count-item"><div class="num" id="minutes">00</div><div class="label">Min</div></div>
      <div class="count-item"><div class="num" id="seconds">00</div><div class="label">Seg</div></div>
    </div>
    <svg class="plane" viewBox="0 0 64 64" aria-hidden="true">
      <g fill="#fff"><path d="M4 30 L52 18 L56 20 L28 34 L60 38 L56 40 L52 42 L4 30 Z"/>
      <rect x="2" y="30" width="6" height="2" fill="#fff"/></g>
    </svg>
    <div class="cta"><button id="manualTrigger">Simular despegue (prueba)</button></div>
  </div>

  <canvas id="confetti"></canvas>

<script>
  /* ---------- Config bÃ¡sica ---------- */
  const eventDate = new Date("2025-09-13T17:00:00");
  const frames = ["Image (1).jpeg","Image (2).jpeg","Image (3).jpeg","Image (4).jpeg"];
  frames.forEach((src,i)=>{document.getElementById("frame"+i).src=src;});

  const plane = document.querySelector('.plane');
  const card  = document.getElementById('card');
  const onlyReveal = document.getElementById('only-reveal');
  const confettiCanvas=document.getElementById('confetti');const ctx=confettiCanvas.getContext('2d');
  function resizeCanvas(){confettiCanvas.width=innerWidth;confettiCanvas.height=innerHeight;}
  resizeCanvas();addEventListener('resize',resizeCanvas);

  /* ---------- Sonidos ---------- */
  const snd={
    ding:document.getElementById('snd-ding'),
    engine:document.getElementById('snd-engine'),
    wind:document.getElementById('snd-wind'),
    touch:document.getElementById('snd-touch'),
    reverse:document.getElementById('snd-reverse'),
    roar:document.getElementById('snd-roar'),
    crowd:document.getElementById('snd-crowd')
  };
  function play(a,vol=1){try{a.volume=vol;a.currentTime=0;a.play();}catch(e){}}
  function fadeOut(a,ms=1500){
    try{const step=50,dec=a.volume/(ms/step);
      const id=setInterval(()=>{a.volume=Math.max(0,a.volume-dec);if(a.volume<=0){a.pause();clearInterval(id)}},step);
    }catch(e){}
  }

  /* ---------- Aplausos garantizados (MP3 si existe, WebAudio si no) ---------- */
  let AC=null, masterG=null;
  function ensureAC(){if(!AC){AC=new (window.AudioContext||window.webkitAudioContext)();masterG=AC.createGain();masterG.connect(AC.destination);}}
  function randomNoiseBuffer(len=0.18){const n=Math.floor(len*AC.sampleRate);const buf=AC.createBuffer(1,n,AC.sampleRate);const d=buf.getChannelData(0);for(let i=0;i<n;i++)d[i]=(Math.random()*2-1)*(1-i/n);return buf;}
  function scheduleClap(t){const src=AC.createBufferSource();src.buffer=randomNoiseBuffer(0.12+Math.random()*0.06);const bp=AC.createBiquadFilter();bp.type='bandpass';bp.frequency.value=1800+Math.random()*1200;bp.Q.value=4;const g=AC.createGain();g.gain.setValueAtTime(0,t);g.gain.linearRampToValueAtTime(1,t+0.01);g.gain.exponentialRampToValueAtTime(0.001,t+0.2);src.connect(bp);bp.connect(g);g.connect(masterG);src.start(t);}
  function scheduleCheer(start,dur){const src=AC.createBufferSource();const b=AC.createBuffer(1,AC.sampleRate*dur,AC.sampleRate);const d=b.getChannelData(0);let a=0,b0=0;for(let i=0;i<d.length;i++){const w=Math.random()*2-1;a=0.997*a+w*0.03;b0=0.985*b0+a*0.08;d[i]=b0*0.3;}src.buffer=b;const g=AC.createGain();g.gain.setValueAtTime(0,start);g.gain.linearRampToValueAtTime(0.45,start+0.5);g.gain.linearRampToValueAtTime(0.0,start+dur);src.connect(g);g.connect(masterG);src.start(start);src.stop(start+dur+0.1);}
  function applauseFallback(ms=6000){
    ensureAC(); if(AC.state==='suspended') AC.resume();
    const now=AC.currentTime+0.02; const dur=ms/1000;
    scheduleCheer(now,dur);
    let t=now; while(t<now+dur){const burst=6+Math.floor(Math.random()*8);for(let i=0;i<burst;i++)scheduleClap(t+Math.random()*0.2);t+=0.35+Math.random()*0.4;}
  }
  function playApplauseGuaranteed(){
    // intenta archivo real
    if(snd.crowd && snd.crowd.src){
      const p=snd.crowd.play?.();
      if(p && typeof p.then==='function'){
        p.then(()=> setTimeout(()=> fadeOut(snd.crowd,1800),6000))
         .catch(()=> applauseFallback(6000));
      }else{
        // si play no devuelve promesa o falla silenciosamente, disparamos fallback
        setTimeout(()=> fadeOut(snd.crowd,1800),6000);
      }
    }else{
      applauseFallback(6000);
    }
  }

  /* ---------- Cuenta regresiva (solo para la demo) ---------- */
  const days=document.getElementById('days'),hours=document.getElementById('hours'),minutes=document.getElementById('minutes'),seconds=document.getElementById('seconds');
  function pad(n){return String(n).padStart(2,'0');}
  function tick(){
    const now=new Date();const diff=eventDate-now;
    if(diff<=0){trigger();clearInterval(tmr);return;}
    const s=Math.floor(diff/1000)%60,m=Math.floor(diff/60000)%60,h=Math.floor(diff/3600000)%24,d=Math.floor(diff/86400000);
    days.textContent=pad(d);hours.textContent=pad(h);minutes.textContent=pad(m);seconds.textContent=pad(s);
  }
  const tmr=setInterval(tick,1000); tick();

  /* ---------- Secuencia de aterrizaje ---------- */
  function playLandingSequence(done){
    const seq=document.getElementById('runway-seq');
    seq.classList.add('show');
    try{snd.engine.volume=.4; snd.engine.play();}catch(e){}
    try{snd.wind.volume=.5; snd.wind.play();}catch(e){}
    play(snd.roar,.6);

    const times=[1100,1600,1900,2300];
    frames.forEach((_,i)=>{
      const img=document.getElementById("frame"+i);
      setTimeout(()=>{
        document.querySelectorAll('#runway-seq img').forEach(el=>el.classList.remove('show'));
        img.classList.add('show');
        if(i===frames.length-1){
          img.classList.add('touchdown');
          setTimeout(()=>{
            play(snd.touch,.95);
            setTimeout(()=>play(snd.reverse,.9),150);
            done && done();
          },700);
        }
      }, times.slice(0,i+1).reduce((a,b)=>a+b,0));
    });
  }

  /* ---------- Texto + limpieza visual ---------- */
  function revealOnlySign(){
    // ocultar tarjeta completa + confetti
    card.classList.add('hide-out');
    confettiCanvas.classList.add('confetti-hidden');

    // mostrar Ãºnico letrero
    onlyReveal.classList.add('show');

    // Sonidos finales
    speakReveal();
    playApplauseGuaranteed();

    // apagar ambiente
    setTimeout(()=>{ try{ fadeOut(snd.wind,1000); fadeOut(snd.engine,1800); }catch(e){} }, 1200);
  }

  /* ---------- TTS (piloto + revelaciÃ³n) ---------- */
  function pilotAnnouncement(){
    if(!('speechSynthesis'in window))return;
    const speak=(text,{lang="es-ES",rate=0.85,pitch=0.8}={})=>new Promise(res=>{const u=new SpeechSynthesisUtterance(text);u.lang=lang;u.rate=rate;u.pitch=pitch;u.onend=res;speechSynthesis.speak(u);});
    (async()=>{
      await speak("SeÃ±oras y seÃ±ores, les habla su capitÃ¡n. Bienvenidos a bordo. Estamos listos para salir con destino a Pinklandia o Bluelandia.",{lang:"es-ES"});
      await new Promise(r=>setTimeout(r,1500)); play(snd.roar,0.9);
      await new Promise(r=>setTimeout(r,1000)); await speak("Â¡Despegamos!",{lang:"es-ES",rate:0.8,pitch:0.72});
      await new Promise(r=>setTimeout(r,700)); await speak("Ladies and gentlemen, this is your captain speaking. Welcome aboard. We are ready for departure to Pinklandia or Bluelandia.",{lang:"en-US"});
      await new Promise(r=>setTimeout(r,800)); await speak("We are taking off!",{lang:"en-US",rate:0.84,pitch:0.8});
    })();
  }

  function speakReveal(){
    if(!('speechSynthesis'in window))return;
    const shout=(text,{lang="es-ES",rate=1.15,pitch=1.25,delay=0}={})=>{
      setTimeout(()=>{const u=new SpeechSynthesisUtterance(text);u.lang=lang;u.rate=rate;u.pitch=pitch; speechSynthesis.speak(u);},delay);
    };
    shout("Â¡Â¡Â¡ES UNA NIÃ‘A!!!",{lang:"es-ES",rate:1.2,pitch:1.35});
    shout("Â¡FELICIDADES!",{lang:"es-ES",rate:1.12,pitch:1.2,delay:900});
    shout("IT'S A GIRL!",{lang:"en-US",rate:1.18,pitch:1.3,delay:2000});
  }

  /* ---------- Confetti (se oculta al revelar) ---------- */
  let confetti=[]; function startConfetti(){confetti.length=0;for(let i=0;i<220;i++){confetti.push({x:Math.random()*confettiCanvas.width,y:Math.random()*confettiCanvas.height-confettiCanvas.height,r:Math.random()*6+4,d:Math.random()*20+10,color:"hsl("+(Math.random()*30+330)+",100%,70%)"});} requestAnimationFrame(draw);}
  function draw(){ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);for(let i=0;i<confetti.length;i++){const c=confetti[i];ctx.fillStyle=c.color;ctx.fillRect(c.x,c.y,c.r,c.r);c.y+=c.d/20;if(c.y>confettiCanvas.height){c.y=-10;c.x=Math.random()*confettiCanvas.width;}}requestAnimationFrame(draw);}

  /* ---------- OrquestaciÃ³n ---------- */
  function trigger(){
    // desbloquear web audio en mÃ³viles
    try{ensureAC(); if(AC.state==='suspended') AC.resume();}catch(e){}
    try{play(snd.ding,.9);}catch(e){}
    pilotAnnouncement();
    plane.classList.add('takeoff');
    setTimeout(()=>{
      plane.classList.remove('takeoff');
      startConfetti();
      playLandingSequence(revealOnlySign);
    },1600);
  }

  document.getElementById('manualTrigger').addEventListener('click', trigger);

  // Si quieres que todo inicie solo al llegar la hora exacta, deja esto:
  // (Por ahora lo mantenemos, pero el botÃ³n "Simular" reproduce todo al instante)
  function checkTime(){
    const now=new Date();
    if(now>=eventDate){ trigger(); clearInterval(checker); }
  }
  const checker=setInterval(checkTime,10000);
</script>
</body>
</html>
