<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Revelaci√≥n de sexo ‚Äî Destino</title>
<style>
  :root{
    --pink:#ffd6e8; --blue:#d6ebff;
    --bg1:linear-gradient(90deg,var(--pink),var(--blue));
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  }
  html,body{height:100%;margin:0}
  body{
    background:var(--bg1);
    display:flex;align-items:center;justify-content:center;
    color:#222;overflow:hidden;
  }

  /* üåÜ Pinklandia background city */
  #pinklandia-bg{
    position:fixed;inset:0;
    background:url("pinklandia-city.jpg") bottom center/cover no-repeat;
    opacity:0;transition:opacity 2s ease;z-index:0;
  }
  #pinklandia-bg.show{opacity:1;animation:panCity 20s linear infinite alternate}
  @keyframes panCity{0%{background-position:bottom left}100%{background-position:bottom right}}

  /* üéûÔ∏è Secuencia de aterrizaje (frames) */
  #runway-seq{position:fixed;inset:0;z-index:2;opacity:0;transition:opacity .4s ease;background:#000}
  #runway-seq.show{opacity:1}
  #runway-seq img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}

  /* ü§¢ Turbulencia */
  @keyframes shake{
    0%{transform:translate(0,0) rotate(0deg)}
    20%{transform:translate(-2px,1px) rotate(-.2deg)}
    40%{transform:translate(3px,-1px) rotate(.3deg)}
    60%{transform:translate(-1px,2px) rotate(-.3deg)}
    80%{transform:translate(2px,0) rotate(.2deg)}
    100%{transform:translate(0,0) rotate(0deg)}
  }
  .camera-shake{animation:shake .12s linear infinite}

  /* üí• Touchdown */
  @keyframes bump{
    0%{transform:translateY(0) scale(1);filter:brightness(1)}
    20%{transform:translateY(6px) scale(.995);filter:brightness(.95)}
    45%{transform:translateY(-2px) scale(1.002);filter:brightness(1.05)}
    100%{transform:translateY(0) scale(1);filter:brightness(1)}
  }
  .touchdown-bump{animation:bump .55s ease-out 1}

  .card{
    width:92%;max-width:1000px;background:rgba(255,255,255,.08);
    border-radius:20px;padding:28px;box-shadow:0 10px 30px rgba(0,0,0,.12);
    backdrop-filter:blur(6px);text-align:center;position:relative;z-index:10;
  }
  h1{margin:6px 0 4px;font-size:50px;color:#fff}
  .subtitle{color:rgba(255,255,255,.9);margin-bottom:18px}
  .countdown{display:flex;gap:12px;justify-content:center;margin:18px 0}
  .count-item{background:rgba(255,255,255,.14);padding:12px 18px;border-radius:12px;min-width:84px}
  .count-item .num{font-size:40px;font-weight:700;color:#fff}
  .count-item .label{font-size:18px;color:rgba(255,255,255,.9)}

  /* ‚úàÔ∏è Avi√≥n SVG (despegue) */
  .plane{width:160px;position:absolute;left:-200px;bottom:150px;opacity:0;transition:all 1s linear;z-index:15}
  .plane.takeoff{animation:takeoff 2s ease-in forwards}
  .plane.landing{animation:landing 3s ease-out forwards}
  @keyframes takeoff{0%{left:10%;bottom:150px;opacity:1}100%{left:120%;bottom:60%;opacity:0}}
  @keyframes landing{0%{left:120%;bottom:80%;opacity:1;transform:rotate(10deg)}
                     100%{left:50%;bottom:150px;opacity:1;transform:rotate(0deg) translateX(-50%)}}

  .reveal{margin-top:22px;font-size:36px;font-weight:700;opacity:0;transition:opacity 1s ease .6s}
  .reveal.show{opacity:1;color:#ff4fa3;text-shadow:0 5px 18px rgba(0,0,0,.4)}

  canvas#confetti{position:fixed;inset:0;pointer-events:none;z-index:5}

  .cta{margin-top:12px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap}
  #manualTrigger, #muteBtn{padding:10px 16px;border-radius:10px;border:0;cursor:pointer}
</style>
</head>
<body>
  <div id="pinklandia-bg"></div>
  <div id="runway-seq"><img alt="secuencia aterrizaje" /></div>

  <!-- üîä Audio -->
  <audio id="snd-ding"    src="seatbelt-ding.mp3" preload="auto"></audio>
  <audio id="snd-engine"  src="engine-loop.mp3"    preload="auto" loop></audio>
  <audio id="snd-wind"    src="wind-rumble.mp3"    preload="auto" loop></audio>
  <audio id="snd-touch"   src="touchdown-thump.mp3" preload="auto"></audio>
  <audio id="snd-reverse" src="reverse-thrust.mp3"  preload="auto"></audio>
  <audio id="snd-roar"    src="takeoff-roar.mp3"    preload="auto"></audio>

  <canvas id="confetti"></canvas>

  <div class="card">
    <h1>¬°Despegando hacia...?</h1>
    <div class="subtitle">Destino: <strong>Bluelandia</strong> o <strong>Pinklandia</strong></div>

    <div id="countdown" class="countdown">
      <div class="count-item"><div class="num" id="days">00</div><div class="label">D√≠as</div></div>
      <div class="count-item"><div class="num" id="hours">00</div><div class="label">Horas</div></div>
      <div class="count-item"><div class="num" id="minutes">00</div><div class="label">Min</div></div>
      <div class="count-item"><div class="num" id="seconds">00</div><div class="label">Seg</div></div>
    </div>

    <!-- ‚úàÔ∏è SVG -->
    <svg class="plane" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <g fill="#fff">
        <path d="M4 30 L52 18 L56 20 L28 34 L60 38 L56 40 L52 42 L4 30 Z" opacity="0.95"/>
        <rect x="2" y="30" width="6" height="2" fill="#fff"/>
      </g>
    </svg>

    <div id="revealText" class="reveal">¬øNi√±o o Ni√±a?</div>

    <div class="cta">
      <button id="manualTrigger">Simular despegue (prueba)</button>
      <button id="muteBtn" aria-pressed="false">üîä Audio: ON</button>
    </div>
  </div>

<script>
  // ‚è±Ô∏è Ajusta a tu hora local (America/New_York): Sep 13, 2025 17:00
  const eventDate = new Date("2025-09-13T17:00:00");

  const plane = document.querySelector('.plane');
  const runwaySeq = document.getElementById('runway-seq');
  const runwayImg = runwaySeq.querySelector('img');
  const muteBtn = document.getElementById('muteBtn');
  let didTrigger = false;
  let isMuted = false;

  // üéûÔ∏è Frames (√∫ltimo = Pinklandia)
  const frames = ["Image (1).jpeg","Image (2).jpeg","Image (3).jpeg","Image (4).jpeg"];
  frames.forEach(src => { const i = new Image(); i.src = src; });

  // üîä sonidos
  const snd = {
    ding: document.getElementById('snd-ding'),
    engine: document.getElementById('snd-engine'),
    wind: document.getElementById('snd-wind'),
    touch: document.getElementById('snd-touch'),
    reverse: document.getElementById('snd-reverse'),
    roar: document.getElementById('snd-roar')
  };
  function applyMute(){ Object.values(snd).forEach(a => a.muted = isMuted); }
  function play(a, vol=1){
    try{ a.volume=vol; a.currentTime=0; a.play(); }catch(e){}
  }
  function fadeInLoop(a, to=1, ms=1500){
    try{
      a.volume=0; a.loop=true; a.currentTime=0; a.play();
      const step=50; const inc=(to-0)/(ms/step);
      const id=setInterval(()=>{ a.volume=Math.min(to,a.volume+inc); if(a.volume>=to) clearInterval(id); },step);
    }catch(e){}
  }
  function fadeOut(a, ms=1000){
    try{
      const step=50; const dec=a.volume/(ms/step);
      const id=setInterval(()=>{ a.volume=Math.max(0,a.volume-dec); if(a.volume<=0){a.pause(); clearInterval(id);} },step);
    }catch(e){}
  }

  // ‚è±Ô∏è contador
  function pad(n){ return String(n).padStart(2,'0'); }
  function updateTimer(){
    const now = new Date();
    const diff = eventDate - now;
    if(diff <= 0){ triggerTakeoff(); clearInterval(timerInterval); return; }
    const s = Math.floor(diff/1000)%60;
    const m = Math.floor(diff/60000)%60;
    const h = Math.floor(diff/3600000)%24;
    const d = Math.floor(diff/86400000);
    days.textContent = pad(d); hours.textContent = pad(h);
    minutes.textContent = pad(m); seconds.textContent = pad(s);
  }
  const days=document.getElementById('days'),
        hours=document.getElementById('hours'),
        minutes=document.getElementById('minutes'),
        seconds=document.getElementById('seconds');

  // üéôÔ∏è Anuncio de piloto (ES + EN) con pausa larga y rugido
  function pilotAnnouncement(){
    if(!('speechSynthesis' in window)) return;

    const speak = (text, {rate=0.84, pitch=0.8, lang="es-ES"}={}) => new Promise(resolve=>{
      const u = new SpeechSynthesisUtterance(text);
      u.lang = lang; u.rate = rate; u.pitch = pitch;
      const voices = speechSynthesis.getVoices();
      const male = voices.find(v => v.lang.startsWith(lang.slice(0,2)) && /male|hombre|Alejandro|Jorge|Diego|Miguel|Enrique|Jose|Male/i.test(v.name));
      if(male) u.voice = male;
      u.onend = resolve;
      speechSynthesis.speak(u);
    });

    (async ()=>{
      await speak("Se√±oras y se√±ores, les habla su capit√°n. Bienvenidos a bordo. Estamos listos para salir con destino a Pinklandia o Bluelandia.", {rate:0.82, pitch:0.78, lang:"es-ES"});
      await new Promise(r=>setTimeout(r, 1400)); // pausa larga
      play(snd.roar, 0.9);                        // rugido entre la pausa y el despegue
      await new Promise(r=>setTimeout(r, 900));
      await speak("¬°Despegamos!", {rate:0.78, pitch:0.72, lang:"es-ES"});

      await new Promise(r=>setTimeout(r, 600));
      await speak("Ladies and gentlemen, this is your captain speaking. Welcome aboard. We are ready for departure to Pinklandia or Bluelandia.", {rate:0.84, pitch:0.80, lang:"en-US"});
      await new Promise(r=>setTimeout(r, 800));
      await speak("We are taking off!", {rate:0.82, pitch:0.78, lang:"en-US"});
    })();
  }

  // üéûÔ∏è Aterrizaje m√°s lento + sincron√≠a de sonidos
  function playLandingSequence(onDone){
    runwaySeq.classList.add('show');
    document.body.classList.add('camera-shake');

    fadeInLoop(snd.engine, 0.40, 1500);
    fadeInLoop(snd.wind,   0.50, 1500);
    play(snd.roar, 0.6); // rugido suave al inicio del approach

    let i = 0;
    const frameTime = 750; // m√°s lento para dramatismo
    function next(){
      runwayImg.src = frames[i]; i++;
      if(i < frames.length - 1){
        setTimeout(next, frameTime);
      } else {
        document.body.classList.remove('camera-shake');
        runwaySeq.classList.add('touchdown-bump');
        fadeOut(snd.wind, 600);
        play(snd.touch, 0.9);                 // üí• touchdown
        setTimeout(()=> play(snd.reverse, 0.85), 120); // reversa casi inmediata
        setTimeout(()=> fadeOut(snd.engine, 2000), 2000);
        setTimeout(()=> onDone && onDone(), 700);
      }
    }
    setTimeout(next, 900); // peque√±o margen antes del primer frame
  }

  // üîä Revelaci√≥n con m√°s √°nimo (ES + EN)
  function speakReveal(){
    if(!('speechSynthesis' in window)) return;

    const shout = (text, {lang="es-ES", rate=1.1, pitch=1.2}={}) => {
      const u = new SpeechSynthesisUtterance(text);
      u.lang = lang; u.rate = rate; u.pitch = pitch;
      const voices = speechSynthesis.getVoices();
      const v = voices.find(v => v.lang.startsWith(lang.slice(0,2)) && /male|hombre|Alejandro|Jorge|Diego|Miguel|Enrique|Jose|Male/i.test(v.name));
      if(v) u.voice = v;
      window.speechSynthesis.speak(u);
    };

    shout("¬°Es una ni√±a! ¬°Felicidades!", {lang:"es-ES", rate:1.15, pitch:1.3});
    setTimeout(()=> shout("It's a girl! Congratulations!", {lang:"en-US", rate:1.05, pitch:1.2}), 900);
  }

  function revealPinklandia(){
    const t = document.getElementById('revealText');
    t.textContent = "¬°Es una Ni√±a! üíñ";
    t.classList.add('show');
    document.body.style.background = "#ffd6e8";
    document.getElementById('pinklandia-bg').classList.add('show');
    startConfetti();
    speakReveal();
  }

  function triggerTakeoff(){
    if(didTrigger) return; didTrigger = true;

    applyMute(); // respeta el estado del bot√≥n
    play(snd.ding, 0.9);    // campanilla
    pilotAnnouncement();    // üéôÔ∏è anuncio de piloto

    plane.classList.add('takeoff'); // despega el SVG

    setTimeout(()=>{
      plane.classList.remove('takeoff');
      plane.classList.add('landing'); // opcional (queda detr√°s)
      playLandingSequence(revealPinklandia);
    }, 1600);
  }

  document.getElementById('manualTrigger').addEventListener('click', ()=>{
    // El clic desbloquea audio en m√≥viles
    applyMute();
    triggerTakeoff();
  });

  // Bot√≥n Mute/Unmute
  muteBtn.addEventListener('click', ()=>{
    isMuted = !isMuted; applyMute();
    muteBtn.textContent = isMuted ? "üîá Audio: OFF" : "üîä Audio: ON";
    muteBtn.setAttribute('aria-pressed', String(!isMuted));
  });

  updateTimer(); const timerInterval = setInterval(updateTimer, 1000);

  // üéâ Confetti
  const confettiCanvas = document.getElementById('confetti');
  const ctx = confettiCanvas.getContext('2d');
  function resizeCanvas(){ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight; }
  resizeCanvas(); addEventListener('resize', resizeCanvas);
  let confetti = [];
  function startConfetti(){
    confetti.length = 0;
    for(let i=0;i<220;i++){
      confetti.push({ x:Math.random()*confettiCanvas.width,
        y:Math.random()*confettiCanvas.height - confettiCanvas.height,
        r:Math.random()*6+4, d:Math.random()*20+10,
        color:"hsl("+(Math.random()*30+330)+",100%,70%)" });
    }
    requestAnimationFrame(drawConfetti);
  }
  function drawConfetti(){
    ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
    for(let i=0;i<confetti.length;i++){
      let c=confetti[i]; ctx.fillStyle=c.color; ctx.fillRect(c.x,c.y,c.r,c.r);
      c.y += c.d/20; if(c.y>confettiCanvas.height){ c.y=-10; c.x=Math.random()*confettiCanvas.width; }
    }
    requestAnimationFrame(drawConfetti);
  }
</script>
</body>
</html>
